@using WebUF.ViewModel

@model List<EstadoViewModel> 

@{
    ViewData["Title"] = "Estados do Brasil";
}


<div class="container my-5 text-center">

    @using (Html.BeginForm("ConsultaSigla", "Home", FormMethod.Post))
{
    <h2 class="mb-4">Lista de Estados</h2>
    <div class="table-responsive">
        <table class="table table-bordered table-striped mx-auto w-75">
            <thead class="table-dark">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Sigla</th>
                    <th scope="col">Nome</th>
                    <th scope="col">Descrição</th>
                    <!-- Adicionado Descrição, pois está no ViewModel -->
                </tr>
            </thead>
            <tbody id="tabelaCorpo">
                    @await Html.PartialAsync("_TabelaEstados", Model)
            </tbody>
        </table>
    </div>
    <div class="mb-3 w-50 mx-auto">
            @Html.TextBox("sigla", null, new { @class = "form-control mb-2", placeholder = "Digite a sigla do estado (ex: SP)" })
            <button class="btn btn-primary w-100" id="inputSiglaBusca">Verificar Estado</button>
        <div id="resultadoVerificacao" class="mt-3"></div>
    </div>
}
<script>
    $(document).ready(function() {
        $("#inputSiglaBusca").click(function (event) {
            event.preventDefault(); // Evita o envio padrão do formulário
            var sigla = $("input[name='sigla']").val().trim().toUpperCase();
            if (sigla === "") {
                $("#resultadoVerificacao").html('<div class="alert alert-warning">Por favor, insira uma sigla.</div>');
                return;
            }
            $.ajax({
                url: '@Url.Action("ConsultaSigla", "Home")',
                type: 'POST',
                data: { sigla: sigla },
                success: function (data) {
                    if (data && data.nome) {
                        $("#resultadoVerificacao").html('<div class="alert alert-success">Estado encontrado: ' + data.nome + ' (' + data.sigla + ')</div>');
                    } else {
                        $("#resultadoVerificacao").html('<div class="alert alert-danger">Estado não encontrado para a sigla: ' + sigla + '</div>');
                    }
                },
                error: function () {
                    $("#resultadoVerificacao").html('<div class="alert alert-danger">Erro ao consultar o estado. Tente novamente.</div>');
                }
            });
        });
    });
</script>



</div>

